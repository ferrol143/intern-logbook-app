{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/env.ts"],"sourcesContent":["import { z } from 'zod';\r\n\r\nconst envSchema = z.object({\r\n  NODE_ENV: z.enum(['development', 'production', 'test']),\r\n  DATABASE_URL: z.string().url(),\r\n  NEXTAUTH_SECRET: z.string().min(32),\r\n  NEXTAUTH_URL: z.string().url(),\r\n  JWT_SECRET: z.string().min(32),\r\n});\r\n\r\nexport const env = envSchema.parse(process.env);"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,YAAY,qLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACzB,UAAU,qLAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAe;QAAc;KAAO;IACtD,cAAc,qLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG;IAC5B,iBAAiB,qLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IAChC,cAAc,qLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG;IAC5B,YAAY,qLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC;AAC7B;AAEO,MAAM,MAAM,UAAU,KAAK,CAAC,QAAQ,GAAG"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport type { NextRequest } from 'next/server';\r\nimport { getToken } from 'next-auth/jwt';\r\nimport { env } from '../lib/env';\r\n\r\nconst protectedPaths = ['/dashboard', '/api'];\r\n\r\nexport async function middleware(req: NextRequest) {\r\n  const { pathname } = req.nextUrl;\r\n\r\n  // Handle CORS preflight\r\n  if (req.method === 'OPTIONS') {\r\n    const preflight = new NextResponse(null, { status: 200 });\r\n    addCORSHeaders(preflight);\r\n    return preflight;\r\n  }\r\n\r\n  // Check protected route\r\n  const isProtected = protectedPaths.some((path) => pathname.startsWith(path));\r\n\r\n  if (isProtected) {\r\n    const token = await getToken({\r\n      req,\r\n      secret: env.NEXTAUTH_SECRET,\r\n    });\r\n\r\n    if (!token) {\r\n      // Redirect ke login kalau token tidak valid\r\n      const loginUrl = new URL('/auth/login', req.url);\r\n      return NextResponse.redirect(loginUrl);\r\n    }\r\n  }\r\n\r\n  // Continue request\r\n  const response = NextResponse.next();\r\n  addCORSHeaders(response);\r\n  addSecurityHeaders(response);\r\n  return response;\r\n}\r\n\r\n// Helper functions\r\nfunction addCORSHeaders(res: NextResponse) {\r\n  res.headers.set('Access-Control-Allow-Origin', '*');\r\n  res.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\r\n  res.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization');\r\n}\r\n\r\nfunction addSecurityHeaders(res: NextResponse) {\r\n  res.headers.set('X-Frame-Options', 'DENY');\r\n  res.headers.set('X-Content-Type-Options', 'nosniff');\r\n  res.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\r\n}\r\n\r\nexport const config = {\r\n  matcher: ['/dashboard/:path*', '/api/:path*'],\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;AACA;;;;AAEA,MAAM,iBAAiB;IAAC;IAAc;CAAO;AAEtC,eAAe,WAAW,GAAgB;IAC/C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,wBAAwB;IACxB,IAAI,IAAI,MAAM,KAAK,WAAW;QAC5B,MAAM,YAAY,IAAI,6LAAA,CAAA,eAAY,CAAC,MAAM;YAAE,QAAQ;QAAI;QACvD,eAAe;QACf,OAAO;IACT;IAEA,wBAAwB;IACxB,MAAM,cAAc,eAAe,IAAI,CAAC,CAAC,OAAS,SAAS,UAAU,CAAC;IAEtE,IAAI,aAAa;QACf,MAAM,QAAQ,MAAM,CAAA,GAAA,oJAAA,CAAA,WAAQ,AAAD,EAAE;YAC3B;YACA,QAAQ,kHAAA,CAAA,MAAG,CAAC,eAAe;QAC7B;QAEA,IAAI,CAAC,OAAO;YACV,4CAA4C;YAC5C,MAAM,WAAW,IAAI,IAAI,eAAe,IAAI,GAAG;YAC/C,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;QAC/B;IACF;IAEA,mBAAmB;IACnB,MAAM,WAAW,6LAAA,CAAA,eAAY,CAAC,IAAI;IAClC,eAAe;IACf,mBAAmB;IACnB,OAAO;AACT;AAEA,mBAAmB;AACnB,SAAS,eAAe,GAAiB;IACvC,IAAI,OAAO,CAAC,GAAG,CAAC,+BAA+B;IAC/C,IAAI,OAAO,CAAC,GAAG,CAAC,gCAAgC;IAChD,IAAI,OAAO,CAAC,GAAG,CAAC,gCAAgC;AAClD;AAEA,SAAS,mBAAmB,GAAiB;IAC3C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACnC,IAAI,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC1C,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;AACrC;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;KAAc;AAC/C"}}]
}